
<!doctype html>
<head>
    <meta charset="UTF-8">
    <link href='css/site.css' rel='stylesheet' />
</head>
<body>
    <div class='site-header'>
        <a href=../index.html>dice.js</a>
    </div>
    <div class='site-content'>
        <p><h3>demo</h3></p>
        <input id='diceInput' placeHolder='example:2d6+4'>
        <p>Example inputs: </p>
        <ul class='text-small'>
            <li>2d6: Die rolls. 2d6 rolls two six-sided die and returns the sum of the rolls.</li>
            <li>(2+6/2)^2: Math equations. Supports parentheses (), exponents ^, multiplication *, division /, addition +, and subtraction - </li>
            <li>d20+1d6+5: Combination of multiple rolls and math.</li>
            <li>2xd20: Will roll two twenty-sided die, but will keep the rolls separated. Used in game rules where the player 
                selects the higher or lower of two rolls. 
            </li>
        </ul>
        
        
        <span id='diceOutput'>Output: </span>
        <p><h3>functionality</h3></p>
        <p>The dice roller is modular. With no modules loaded, it is a simple random number generator. Each module extends its functionality. The idea behind this is that it can be tailored for different games where different types of dice rolls need to be made. 
        </p>
        <p>The math module extends the dice roller with the ability to handle PEMDAS operations using the symbols ()^*/+-. </p>
        <p>Broadly speaking, it works by setting up a queue of processes. Each process scans the input to see if it is a valid target (the addition function looks for numbers surrounding a + sign). It then strips out the operators and operands, performs its operation, and inserts the results back into the ongoing equation. So the input equation gets examined and mutated by each process in order until they are all done leaving the result.</p>
</body>

<script type='module'>
    import { DiceRoller } from '../dice.js'
    import { MathModule } from '../modules/math-module.js'
    import { DnDModule } from '../modules/dnd-module.js'
    
    (()=>{
        let dice = new DiceRoller({ modules : [MathModule, DnDModule]})
    
        let input = document.getElementById('diceInput');
        let output = document.getElementById('diceOutput');
        input.addEventListener('keypress', (ev) => { 
            if(ev.key === 'Enter'){
                let solution = dice.solve(ev.target.value); 
                output.innerHTML = 'Output: ' + solution;
            }

            let validKeys = /[d\d()^*/+-x]/g;
            if(!validKeys.test(ev.key)) { return ev.preventDefault(); }
        });
    })()

</script>

