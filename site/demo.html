
<!doctype html>
<head>
    <meta charset="UTF-8">
    <link href='css/site.css' rel='stylesheet' />
    <script src='../dice.js'></script>
    <script src='../modules/math.js'></script>
    <script src='../modules/5e.js'></script>
    <script src='../modules/logging.js'></script>
  
</head>
<body>
    <div class='site-header'>
        <a href=index.html>dice.js</a>
    </div>
    <div class='site-content'>
        <p><h3>demo</h3></p>
        <p>Example inputs: </p>
        <ul>
            <li>d6 or 1d6: roll 1 six-sided die (random number 1-6)</li>
            <li>3d6: roll 3 six sided die and return the sum of the rolls (random number 3-18)</li>
            <li>5+4*2 or (5+4)*2: Solves the given math equation</li>
            <li>d20+1d6+5: adding the results of multiple rolls</li>
            <li>2xd20: This will roll two twenty-sided die, but will keep the rolls separated. This functionality 
                added by the 'dungeons and dragons' module where the game rules sometimes require you to pick the higher or lower of two rolls.
            </li>
        </ul>
        <input id='diceInput' placeHolder='example:3d6+4'>
        <span id='diceOutput'>Output: </span>
        <p><h3>functionality</h3></p>
        <p>The dice roller is modular. With no modules loaded, it is a simple random number generator. Each module extends its functionality. The idea behind this is that it can be tailored for different games where different types of dice rolls need to be made. 
        </p>
        <p>The math module extends the dice roller with the ability to handle PEMDAS operations using the symbols ()^*/+-. </p>
        <p>Broadly speaking, it works by setting up a queue of processes. Each process scans the input to see if it is a valid target (the addition function looks for numbers surrounding a + sign). It then strips out the operators and operands, performs its operation, and inserts the results back into the ongoing equation. So the input equation gets examined and mutated by each process in order until they are all done leaving the result.</p>
</body>

<script>
    (()=>{
        let dice = new DiceRoller();
        dice.operations.add(math_functions);
        dice.operations.insert([0], dnd_functions[0]);
        let input = document.getElementById('diceInput');
        let output = document.getElementById('diceOutput');
        input.addEventListener('keypress', (ev) => { 
            if(ev.key === 'Enter'){
                let solution = dice.solve(ev.target.value); 
                output.innerHTML = 'Output: ' + solution;
            }

            let validKeys = /[d\d()^*/+-x]/g;
            if(!validKeys.test(ev.key)) { return ev.preventDefault(); }
        });
    })()

</script>

